<header>
  <h1>Sistema de Órdenes</h1>
</header>

<!-- Datos del Cliente -->
<section id="cliente">
  <h2>Datos del Cliente</h2>
  <form>
    <div class="form-row">
      <div class="form-group">
        <label>Primer Nombre:</label>
        <input type="text" [(ngModel)]="primerNombre" name="primerNombre" required>
      </div>
      <div class="form-group">
        <label>Segundo Nombre:</label>
        <input type="text" [(ngModel)]="segundoNombre" name="segundoNombre">
      </div>
      <div class="form-group">
        <label>Primer Apellido:</label>
        <input type="text" [(ngModel)]="primerApellido" name="primerApellido" required>
      </div>
      <div class="form-group">
        <label>Segundo Apellido:</label>
        <input type="text" [(ngModel)]="segundoApellido" name="segundoApellido">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Dirección:</label>
        <input type="text" [(ngModel)]="direccion" name="direccion" required>
      </div>
      <div class="form-group">
        <label>Teléfono:</label>
        <input type="tel" [(ngModel)]="telefono" name="telefono">
      </div>
      <div class="form-group">
        <label>Correo electrónico:</label>
        <input type="email" [(ngModel)]="correo" name="correo">
      </div>
      <div class="form-group">
        <label>NIT:</label>
        <input type="text" [(ngModel)]="nit" name="nit" (focus)="focoNit()" (blur)="blurNit()">
      </div>
    </div>
  </form>
</section>
<!-- Selección de Productos con buscador y lista filtrada -->
<section id="productos">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
    <h2>Seleccionar Productos</h2>
    <div style="position: relative;">
      <input type="text"
             [(ngModel)]="filtroProducto"
             placeholder="Buscar producto..."
             class="buscador-productos"
             autocomplete="off" />
      <ul *ngIf="filtroProducto && productosFiltrados.length" class="lista-filtrada" style="position: absolute; top: 100%; left: 0; background: white; border: 1px solid #ccc; width: 100%; z-index: 10; max-height: 150px; overflow-y: auto; padding: 0; margin: 0; list-style: none;">
        <li *ngFor="let item of productosFiltrados" 
            (click)="seleccionarProducto(item)" 
            style="padding: 5px 10px; cursor: pointer;">
          {{ item.nombre }}
        </li>
      </ul>
    </div>
  </div>

  <form id="productos-form" class="form-row">
    <div class="form-group">
      <label>Producto:</label>
      <input type="text" [value]="seleccion?.nombre || ''" readonly />
    </div>

 <div class="form-group">
  <label>Precio Unitario (Q):</label>
  <input type="text" [value]="seleccion ? seleccion.precio : ''" readonly>
</div>


    <div class="form-group">
      <label>Cantidad:</label>
      <input type="number" [(ngModel)]="cantidad" name="cantidad" min="1" [disabled]="!seleccion">
    </div>

    <div class="form-group botones-agregar">
      <button type="button" (click)="agregarProducto()" [disabled]="!seleccion">Agregar a la orden</button>
    </div>
  </form>
</section>


<!-- Resumen de la Orden -->
<section id="resumen">
  <h2>Resumen de Orden</h2>
  <table>
    <thead>
      <tr>
        <th>Producto</th>
        <th>Cantidad</th>
        <th>Precio Unitario (Q)</th>
        <th>Subtotal (Q)</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let fila of resumen">
        <td>{{ fila.nombre }}</td>
        <td>{{ fila.cantidad }}</td>
        <td>Q{{ fila.precio }}</td>
        <td>Q{{ fila.subtotal }}</td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="3"><strong>Total</strong></td>
        <td><strong>Q{{ total }}</strong></td>
      </tr>
    </tfoot>
  </table>

  <div class="botones-orden">
    <button type="button" (click)="confirmarOrden()">Confirmar Orden</button>
    <button type="button" (click)="limpiarOrden()">Limpiar Ventana</button>
    <button type="button" (click)="verOrdenes()">Ver Órdenes</button>
  </div>
</section>

<footer>
  <p>© 2025 Sistema de Órdenes Ing. Anderson</p>
</footer>
